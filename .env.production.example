# TMS Server Production Environment Configuration
# This file is configured for Alibaba Cloud ECS deployment
# DO NOT commit this file to git!

# ============================================
# Environment
# ============================================
ENVIRONMENT=production
DEBUG=false

# ============================================
# Database Configuration (Alibaba Cloud RDS PostgreSQL)
# ============================================
DATABASE_URL=postgresql+asyncpg://postgres:REDACTED_DB_PASSWORD@localhost:5432/tms_production_db
DATABASE_URL_SYNC=postgresql://postgres:REDACTED_DB_PASSWORD@localhost:5432/tms_production_db

# ============================================
# Redis Configuration (Alibaba Cloud Tair Redis)
# ============================================
# Using database 0 for production (staging uses 1)
REDIS_URL=redis://:REDACTED_REDIS_PASSWORD@localhost:6379/0
REDIS_PASSWORD=REDACTED_REDIS_PASSWORD

# ============================================
# GCGC User Management System Integration
# ============================================
USER_MANAGEMENT_API_URL=https://tms.example.com
USER_MANAGEMENT_API_KEY=REDACTED_API_KEY
USER_MANAGEMENT_API_TIMEOUT=60
TMS_API_URL=https://tms.example.com
TMS_API_KEY=REDACTED_API_KEY

# ============================================
# JWT Configuration
# ============================================
# CRITICAL: These MUST match GCGC production's NEXTAUTH_SECRET and tms-client's NEXTAUTH_SECRET
JWT_SECRET=REDACTED_JWT_SECRET
NEXTAUTH_SECRET=REDACTED_JWT_SECRET

# ============================================
# CORS Configuration
# ============================================
# Production domains only
ALLOWED_ORIGINS=https://tms-chat.example.com,https://www.tms-chat.example.com,https://tms.example.com

# ============================================
# GCGC Login URL
# ============================================
GCGC_LOGIN_URL=https://tms.example.com/auth/signin

# ============================================
# Alibaba Cloud OSS Configuration
# ============================================
# TODO: Get AccessKey from Alibaba Cloud Console (see deployment/GET_OSS_CREDENTIALS.md)
OSS_ACCESS_KEY_ID=YOUR_OSS_ACCESS_KEY_ID_HERE
OSS_ACCESS_KEY_SECRET=YOUR_OSS_ACCESS_KEY_SECRET_HERE
OSS_BUCKET_NAME=tms-oss-goli

# Using internal endpoint (ECS in same region = faster + free bandwidth)
OSS_ENDPOINT=oss-ap-southeast-6-internal.aliyuncs.com

# Optional: Prefix for production files to separate from staging
OSS_PREFIX=production/

# ============================================
# File Upload Configuration
# ============================================
MAX_FILE_SIZE=104857600  # 100MB in bytes
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp,video/mp4,video/webm,audio/mpeg,audio/ogg,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

# ============================================
# Security Configuration
# ============================================
# Session configuration
SESSION_TIMEOUT=86400  # 24 hours
MAX_LOGIN_ATTEMPTS=5
LOGIN_TIMEOUT=900  # 15 minutes

# Rate limiting (requests per minute)
API_RATE_LIMIT=100
WS_RATE_LIMIT=50

# ============================================
# WebSocket Configuration
# ============================================
WS_MAX_CONNECTIONS=10000
WS_HEARTBEAT_INTERVAL=30  # seconds
WS_CONNECTION_TIMEOUT=300  # seconds

# ============================================
# Database Connection Pool Configuration
# ============================================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=3600  # seconds
DB_POOL_PRE_PING=true

# ============================================
# Cache Configuration
# ============================================
CACHE_DEFAULT_TTL=600  # 10 minutes
CACHE_USER_TTL=600  # 10 minutes
CACHE_PRESENCE_TTL=300  # 5 minutes
CACHE_SESSION_TTL=86400  # 24 hours

# ============================================
# Logging
# ============================================
LOG_LEVEL=info
