# TMS Server Staging Environment Configuration
# Copy this file to .env.staging and fill in the actual values
# Location: /home/tmsapp/tms-server/.env.staging

# ============================================
# Database Configuration
# ============================================
DATABASE_URL=postgresql+asyncpg://postgres:REDACTED_DB_PASSWORD@localhost:5432/tms_staging_db
DATABASE_URL_SYNC=postgresql://postgres:REDACTED_DB_PASSWORD@localhost:5432/tms_staging_db

# ============================================
# Redis Configuration
# ============================================
# Use database 1 for staging (production uses 0)
REDIS_URL=redis://:REDACTED_REDIS_PASSWORD@localhost:6379/1

# ============================================
# GCGC User Management System Integration
# ============================================
# IMPORTANT: Update these with your actual GCGC staging values
USER_MANAGEMENT_API_URL=https://tms-staging.example.com
USER_MANAGEMENT_API_KEY=your_gcgc_staging_api_key_here
USER_MANAGEMENT_API_TIMEOUT=30
TMS_API_URL=https://tms-staging.example.com
TMS_API_KEY=your_gcgc_staging_api_key_here
GCGC_LOGIN_URL=https://tms-staging.example.com/auth/signin

# ============================================
# JWT Configuration
# ============================================
# CRITICAL: This MUST match GCGC staging's NEXTAUTH_SECRET exactly!
JWT_SECRET=your_gcgc_staging_nextauth_secret_here_minimum_32_characters

# ============================================
# Alibaba Cloud OSS Configuration
# ============================================
# Update with your actual OSS credentials
# Consider using a separate bucket or folder prefix for staging
OSS_ACCESS_KEY_ID=your_oss_access_key_id_here
OSS_ACCESS_KEY_SECRET=your_oss_access_key_secret_here
OSS_BUCKET_NAME=tms-oss-goli
OSS_ENDPOINT=oss-ap-southeast-6.aliyuncs.com

# Use internal endpoint for better performance
# Uncomment if your ECS instance is in the same region as OSS
# OSS_ENDPOINT=oss-ap-southeast-6-internal.aliyuncs.com

# Optional: Use a prefix to separate staging files
# OSS_PREFIX=staging/

# ============================================
# Application Configuration
# ============================================
ENVIRONMENT=staging
DEBUG=true
LOG_LEVEL=debug

# ============================================
# CORS Configuration
# ============================================
# Add your staging domain(s)
ALLOWED_ORIGINS=https://tms-chat-staging.example.com,http://localhost:3000,http://localhost:3001

# ============================================
# Security Configuration
# ============================================
# Session configuration (more relaxed for staging)
SESSION_TIMEOUT=86400  # 24 hours
MAX_LOGIN_ATTEMPTS=10
LOGIN_TIMEOUT=1800  # 30 minutes

# Rate limiting (more relaxed for staging/testing)
API_RATE_LIMIT=200
WS_RATE_LIMIT=100

# ============================================
# File Upload Configuration
# ============================================
MAX_FILE_SIZE=104857600  # 100MB
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/gif,image/webp,video/mp4,video/webm,audio/mpeg,audio/ogg,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

# ============================================
# WebSocket Configuration
# ============================================
WS_MAX_CONNECTIONS=1000  # Lower limit for staging
WS_HEARTBEAT_INTERVAL=30
WS_CONNECTION_TIMEOUT=300

# ============================================
# Database Connection Pool Configuration
# ============================================
DB_POOL_SIZE=10  # Smaller pool for staging
DB_MAX_OVERFLOW=5
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true

# ============================================
# Cache Configuration
# ============================================
CACHE_DEFAULT_TTL=300  # 5 minutes (shorter for staging)
CACHE_USER_TTL=300
CACHE_PRESENCE_TTL=180  # 3 minutes
CACHE_SESSION_TTL=86400

# ============================================
# Email Configuration (Optional)
# ============================================
# Use test email service in staging
# SMTP_HOST=smtp.mailtrap.io
# SMTP_PORT=2525
# SMTP_USER=your_mailtrap_user
# SMTP_PASSWORD=your_mailtrap_password
# SMTP_FROM=staging@tms-chat.example.com
# SMTP_TLS=true

# ============================================
# Monitoring & Logging (Optional)
# ============================================
# Separate Sentry project for staging
# SENTRY_DSN=https://your-staging-sentry-dsn@sentry.io/staging-project-id
# SENTRY_ENVIRONMENT=staging
